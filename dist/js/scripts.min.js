let xhr,monJSON,currentUrl,logo=document.querySelector(".header h1"),movieWrap=document.querySelector(".movies-wrapper"),btn1=document.querySelector(".btn1"),btn2=document.querySelector(".btn2"),btn3=document.querySelector(".btn3"),btn4=document.querySelector(".btn4"),searchRequest=document.querySelector('[name="search-movie"]'),sortBtn=document.querySelectorAll(".sort .sort-btn"),noPoster="http://underscoremusic.co.uk/site/wp-content/uploads/2014/05/no-poster.jpg",movieFramesArray=document.querySelectorAll(".movie-frame");function initFrame(){myCallAjax("https://api.themoviedb.org/3/movie/upcoming?api_key=4250bfd9b87434db15ff28ef57ec3c08&language=en-US&page-1")}function cleanWrapper(){movieWrap.innerHTML=""}function newFrame(e){let t=document.createElement("div");t.classList.add("movie-frame"),t.id=e.id,t.innerHTML='<h2 class="movie-title">'+(e.original_title||e.original_name)+"</h2><img src="+(e.poster_path?'"https://image.tmdb.org/t/p/w500'+e.poster_path:noPoster)+'" alt="" class="movie-img"><p class="movie-synop">'+e.overview+'</p><div class="rate-wrap">   <div class="movie-rate" style="width:'+10*e.vote_average+'%"></div></div>',movieWrap.appendChild(t)}function mySort(e,t,a){switch(a){case 0:return e.original_title?e.original_title.localeCompare(t.original_title):e.original_name.localeCompare(t.original_name);case 1:return e.vote_count<t.vote_count?1:e.vote_count>t.vote_count?-1:0;case 2:return(e=(e.release_date||e.first_air_date).split("/").join(""))<(t=(t.release_date||t.first_air_date).split("/").join(""))?1:t<e?-1:0;default:return}}function arrangeFrame(a){-1==a&&cleanWrapper(),monJSON.results.sort((e,t)=>mySort(e,t,a)).forEach((e,t)=>{-1==a?newFrame(e):document.getElementById(e.id).style.order=t})}function myAjaxFunction(e,t){200==t.status&&4==t.readyState&&(monJSON=JSON.parse(t.responseText),arrangeFrame(e))}function myCallAjax(e,t=-1){xhr=new XMLHttpRequest,xhr.addEventListener("readystatechange",function(){myAjaxFunction(t,this)}),xhr.open("GET",e,!0),xhr.send(),currentUrl=e}function watchForSearch(){myCallAjax("https://api.themoviedb.org/3/search/movie?api_key=4250bfd9b87434db15ff28ef57ec3c08&language=en-US&query="+searchRequest.value+"&page=1&include_adult=false"),this.addEventListener("focusout",()=>this.value="")}btn1.addEventListener("click",()=>{myCallAjax("https://api.themoviedb.org/3/movie/popular?api_key=4250bfd9b87434db15ff28ef57ec3c08&language=en-US&page=1")}),btn2.addEventListener("click",()=>{myCallAjax("https://api.themoviedb.org/3/movie/top_rated?api_key=4250bfd9b87434db15ff28ef57ec3c08&language=en-US&page=1")}),btn3.addEventListener("click",()=>{myCallAjax("https://api.themoviedb.org/3/tv/popular?api_key=4250bfd9b87434db15ff28ef57ec3c08&language=en-US&page=1")}),btn4.addEventListener("click",()=>{myCallAjax("https://api.themoviedb.org/3/tv/top_rated?api_key=4250bfd9b87434db15ff28ef57ec3c08&language=en-US&page=1")}),sortBtn.forEach((e,t)=>{e.addEventListener("click",()=>{arrangeFrame(t)})}),searchRequest.addEventListener("keyup",watchForSearch),movieFramesArray.forEach(e=>e.addEventListener("click",showDetails));